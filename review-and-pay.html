<script>

const sb = window.supabase.createClient(
  "https://vvjbjfltqsivvxxifnvi.supabase.co",
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ2amJqZmx0cXNpdnZ4eGlmbnZpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc5NzYzNTAsImV4cCI6MjA3MzU1MjM1MH0.F4zzcpCHl9v-Rnj0wgKJ5zBf1HteVyXelMLQDDEN28Q"
);

(async () => {

  // ---------------- GET ORDER ID FROM URL ----------------
  const params = new URLSearchParams(window.location.search);
  const orderId = params.get("order_id");

  if (!orderId) {
    alert("Missing order ID.");
    window.location.href = "catalog.html";
    return;
  }

  // ---------------- FETCH ORDER FROM DATABASE ----------------
  const { data: order, error } = await sb
    .from("pweb_orders")
    .select("*")
    .eq("order_id", orderId)
    .single();

  if (error || !order) {
    alert("Order not found.");
    console.error(error);
    return;
  }

  // ---------------- DISPLAY ORDER SUMMARY ----------------
  document.getElementById("orderId").textContent = order.order_id;
  document.getElementById("docType").textContent = order.doc_type;
  document.getElementById("tier").textContent = order.tier;
  document.getElementById("price").textContent = "$" + order.price;
  document.getElementById("email").textContent = order.email;

  // ---------------- SELECT PAY LINK BY TIER ----------------
  const payLinks = {
    "Tier 1": "YOUR_TIER_1_PAY_LINK",
    "Tier 2": "YOUR_TIER_2_PAY_LINK",
    "Tier 3": "YOUR_TIER_3_PAY_LINK",
    "Tier 4": "YOUR_TIER_4_PAY_LINK"
  };

  const payButton = document.getElementById("payButton");

  if (payLinks[order.tier]) {
    payButton.href = payLinks[order.tier];
  } else {
    payButton.style.display = "none";
  }

})();
</script>
