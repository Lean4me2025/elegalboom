<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>E-LegalBoom | Review & Pay</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f6f8;
    }
    .container {
      max-width: 900px;
      margin: 40px auto;
      background: #ffffff;
      padding: 30px;
      border-radius: 6px;
    }
    h1 {
      margin-bottom: 20px;
    }
    .summary {
      background: #eef2f8;
      padding: 20px;
      border-radius: 4px;
      margin-bottom: 25px;
    }
    .summary p {
      margin: 6px 0;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 25px;
    }
    th, td {
      border-bottom: 1px solid #ddd;
      padding: 10px;
      text-align: left;
    }
    th {
      background: #f0f2f6;
    }
    .total {
      font-size: 18px;
      font-weight: bold;
      text-align: right;
      margin-top: 10px;
    }
    .btn {
      padding: 14px 20px;
      font-size: 16px;
    }
  </style>
</head>

<body>
<div class="container">

  <h1>Review Your Order</h1>

  <!-- ORDER SUMMARY (ANCHOR DISPLAY) -->
  <div class="summary">
    <p><strong>Document Type:</strong> <span id="docType"></span></p>
    <p><strong>Tier:</strong> <span id="tier"></span></p>
    <p><strong>Price:</strong> $<span id="price"></span></p>
  </div>

  <!-- INTAKE DATA REVIEW -->
  <table id="intakeTable">
    <thead>
      <tr>
        <th>Field</th>
        <th>Value</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <div class="total">
    Total: $<span id="total"></span>
  </div>

  <button class="btn" id="payBtn">
    Proceed to Payment
  </button>

</div>

<script>
/* ======================================================
   RECEIVE ORDER LINE (CANONICAL ONLY)
====================================================== */

// Intake is the creator of the order line.
// Review & Pay ONLY receives and displays it.

const intake = JSON.parse(sessionStorage.getItem("intake")) || {};

// Canonical fields
const doc_type = intake.doc_type || "";
const tier = intake.tier || "";
const price = intake.price || "";

// Display anchored values
document.getElementById("docType").textContent = doc_type;
document.getElementById("tier").textContent = tier;
document.getElementById("price").textContent = price;
document.getElementById("total").textContent = price;

/* ======================================================
   RENDER INTAKE DATA (DISPLAY-ONLY)
====================================================== */

const tbody = document.querySelector("#intakeTable tbody");

Object.keys(intake).forEach(key => {
  if (["doc_type", "tier", "price"].includes(key)) return;

  const tr = document.createElement("tr");

  const tdKey = document.createElement("td");
  tdKey.textContent = key.replace(/_/g, " ");

  const tdVal = document.createElement("td");
  tdVal.textContent = intake[key];

  tr.appendChild(tdKey);
  tr.appendChild(tdVal);
  tbody.appendChild(tr);
});

/* ======================================================
   PAYMENT HANDOFF (PLACEHOLDER)
====================================================== */

document.getElementById("payBtn").onclick = () => {

  const order_line = {
    doc_type: doc_type,
    tier: tier,
    price: price,
    intake_data: intake
  };

  console.log("FINAL ORDER LINE (CANONICAL):", order_line);

  alert("Payment wiring will be connected next.");
};
</script>

</body>
</html>
