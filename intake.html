<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>E-LegalBoom — Client Intake</title>

<style>

body{
font-family: Arial, sans-serif;
background:#f4f6fb;
margin:0;
padding:30px;
}

.container{
max-width:900px;
margin:auto;
background:white;
padding:30px;
border-radius:12px;
box-shadow:0 3px 10px rgba(0,0,0,.1);
}

h1{
text-align:center;
margin-bottom:25px;
}

.section{
margin-bottom:25px;
}

.label{
font-weight:bold;
margin-bottom:5px;
display:block;
}

.orderBox{
display:flex;
gap:20px;
margin-bottom:25px;
}

.orderItem{
flex:1;
background:#eef3ff;
padding:15px;
border-radius:10px;
text-align:center;
font-weight:bold;
}

.formGrid{
display:grid;
grid-template-columns:1fr 1fr;
gap:15px;
}

input, textarea{
width:100%;
padding:10px;
border-radius:8px;
border:1px solid #ccc;
}

textarea{
min-height:80px;
grid-column:span 2;
}

button{
margin-top:20px;
width:100%;
padding:15px;
background:#2b60ff;
color:white;
border:none;
border-radius:10px;
font-size:16px;
cursor:pointer;
}

button:hover{
background:#1745cc;
}

</style>
</head>
<body>

<div class="container">

<h1>Client Intake</h1>

<div class="orderBox">
<div class="orderItem" id="tierDisplay">Tier: Loading...</div>
<div class="orderItem" id="docDisplay">Document: Loading...</div>
<div class="orderItem" id="priceDisplay">Price: Loading...</div>
</div>

<form id="intakeForm">

<div class="formGrid">

<input name="client_first_name" placeholder="First Name" required>
<input name="client_last_name" placeholder="Last Name" required>

<input name="client_email" placeholder="Email" required>
<input name="client_phone" placeholder="Phone" required>

<input name="street" placeholder="Street Address">
<input name="unit" placeholder="Unit / Apt">

<input name="city" placeholder="City">
<input name="state" placeholder="State">

<input name="zip" placeholder="ZIP">

<textarea name="order_notes" placeholder="Anything special we should know?"></textarea>

</div>

<button type="submit">Continue To Review</button>

</form>

</div>

<script>

/* ---------------- SAFE PARSE ---------------- */

function safeParse(json){
try{ return JSON.parse(json); }
catch{ return null; }
}

/* ---------------- LOAD ORDER ---------------- */

let order = safeParse(sessionStorage.getItem("elegal_selected_order"));

if(!order){
alert("Missing order. Returning to catalog.");
window.location.href="catalog.html";
}

/* ---------------- DOC → TIER + PRICE MAP ---------------- */

const DOC_MAP = {

PROMISSORY_NOTE:{tier:"Tier 1 — Core Personal & Business",price:39},
NDA:{tier:"Tier 1 — Core Personal & Business",price:39},
INDEPENDENT_CONTRACTOR:{tier:"Tier 1 — Core Personal & Business",price:39},
BILL_OF_SALE:{tier:"Tier 1 — Core Personal & Business",price:39},

LLC_OPERATING:{tier:"Tier 2 — Business Formation & Operations",price:59},
PARTNERSHIP:{tier:"Tier 2 — Business Formation & Operations",price:59},
BUSINESS_LOAN:{tier:"Tier 2 — Business Formation & Operations",price:59},
SERVICE_AGREEMENT:{tier:"Tier 2 — Business Formation & Operations",price:59},

EMPLOYMENT:{tier:"Tier 3 — Employment, Real Estate & Advanced",price:99},
RESIDENTIAL_LEASE:{tier:"Tier 3 — Employment, Real Estate & Advanced",price:99},
COMMERCIAL_LEASE:{tier:"Tier 3 — Employment, Real Estate & Advanced",price:99},
NON_COMPETE:{tier:"Tier 3 — Employment, Real Estate & Advanced",price:99},

TIER4:{tier:"Tier 4 — Entrepreneur Package",price:149}

};

/* ---------------- AUTO REPAIR ---------------- */

if(order.doc_type && DOC_MAP[order.doc_type]){

if(!order.tier){
order.tier = DOC_MAP[order.doc_type].tier;
}

if(!order.price || order.price===0){
order.price = DOC_MAP[order.doc_type].price;
}

}

/* ---------------- DISPLAY ORDER ---------------- */

document.getElementById("tierDisplay").innerText =
"Tier: " + (order.tier || "Unknown Tier");

document.getElementById("docDisplay").innerText =
"Document: " + (order.doc_type || "Unknown");

document.getElementById("priceDisplay").innerText =
"Price: $" + (order.price || 0);

/* ---------------- SUBMIT ---------------- */

document.getElementById("intakeForm").addEventListener("submit", e=>{
e.preventDefault();

const formData = new FormData(e.target);
const intakeData = Object.fromEntries(formData.entries());

sessionStorage.setItem(
"elegal_intake_data",
JSON.stringify({
order,
intakeData
})
);

window.location.href="review-and-pay.html";

});

</script>

</body>
</html>
