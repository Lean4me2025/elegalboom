<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>E-LegalBoom Intake</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
</head>
<body>

<h1>E-LegalBoom Intake</h1>

<form id="intake-form">

  <h3>Client Information</h3>

  <label>First Name</label><br/>
  <input type="text" name="client_first_name" /><br/><br/>

  <label>Last Name</label><br/>
  <input type="text" name="client_last_name" /><br/><br/>

  <label>Email</label><br/>
  <input type="email" name="client_email" /><br/><br/>

  <label>Phone</label><br/>
  <input type="text" name="client_phone" /><br/><br/>

  <label>Business Name</label><br/>
  <input type="text" name="client_business_name" /><br/><br/>

  <h3>Address</h3>

  <label>Street</label><br/>
  <input type="text" name="client_street" /><br/><br/>

  <label>City</label><br/>
  <input type="text" name="client_city" /><br/><br/>

  <label>State</label><br/>
  <select name="client_state">
    <option value="">Select State</option>
    <option value="AL">Alabama</option><option value="AK">Alaska</option>
    <option value="AZ">Arizona</option><option value="AR">Arkansas</option>
    <option value="CA">California</option><option value="CO">Colorado</option>
    <option value="CT">Connecticut</option><option value="DE">Delaware</option>
    <option value="FL">Florida</option><option value="GA">Georgia</option>
    <option value="HI">Hawaii</option><option value="ID">Idaho</option>
    <option value="IL">Illinois</option><option value="IN">Indiana</option>
    <option value="IA">Iowa</option><option value="KS">Kansas</option>
    <option value="KY">Kentucky</option><option value="LA">Louisiana</option>
    <option value="ME">Maine</option><option value="MD">Maryland</option>
    <option value="MA">Massachusetts</option><option value="MI">Michigan</option>
    <option value="MN">Minnesota</option><option value="MS">Mississippi</option>
    <option value="MO">Missouri</option><option value="MT">Montana</option>
    <option value="NE">Nebraska</option><option value="NV">Nevada</option>
    <option value="NH">New Hampshire</option><option value="NJ">New Jersey</option>
    <option value="NM">New Mexico</option><option value="NY">New York</option>
    <option value="NC">North Carolina</option><option value="ND">North Dakota</option>
    <option value="OH">Ohio</option><option value="OK">Oklahoma</option>
    <option value="OR">Oregon</option><option value="PA">Pennsylvania</option>
    <option value="RI">Rhode Island</option><option value="SC">South Carolina</option>
    <option value="SD">South Dakota</option><option value="TN">Tennessee</option>
    <option value="TX">Texas</option><option value="UT">Utah</option>
    <option value="VT">Vermont</option><option value="VA">Virginia</option>
    <option value="WA">Washington</option><option value="WV">West Virginia</option>
    <option value="WI">Wisconsin</option><option value="WY">Wyoming</option>
    <option value="DC">District of Columbia</option>
  </select><br/><br/>

  <label>ZIP</label><br/>
  <input type="text" name="client_zip" /><br/><br/>

  <h3>Document Details</h3>

  <label>Document Type</label><br/>
  <input type="text" name="doc_type" /><br/><br/>

  <label>Governing State</label><br/>
  <input type="text" name="governing_state" /><br/><br/>

  <label>Details</label><br/>
  <textarea name="details"></textarea><br/><br/>

  <label>Notes</label><br/>
  <textarea name="notes"></textarea><br/><br/>

  <button type="submit">Submit Intake</button>

</form>

<script type="module">
  import { createClient } from "https://esm.sh/@supabase/supabase-js@2";

  /* ===============================
     REQUIRED SUPABASE CONFIG
     =============================== */
  const SUPABASE_URL = "https://vvjbjfltqsivvxxifnvi.supabase.co";
  const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ2amJqZmx0cXNpdnZ4eGlmbnZpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc5NzYzNTAsImV4cCI6MjA3MzU1MjM1MH0.F4zzcpCHl9v-Rnj0wgKJ5zBf1HteVyXelMLQDDEN28Q";

  const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

  const form = document.getElementById("intake-form");

  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    const payload = {
      client_first_name: form.client_first_name.value || null,
      client_last_name: form.client_last_name.value || null,
      client_email: form.client_email.value || null,
      client_phone: form.client_phone.value || null,
      client_business_name: form.client_business_name.value || null,
      client_street: form.client_street.value || null,
      client_city: form.client_city.value || null,
      client_state: form.client_state.value || null,
      client_zip: form.client_zip.value || null,
      doc_type: form.doc_type.value || null,
      governing_state: form.governing_state.value || null,
      details: form.details.value || null,
      notes: form.notes.value || null
    };

    console.log("Submitting payload â†’ pweb_orders", payload);

    const { data, error } = await supabase
      .from("pweb_orders")
      .insert([payload])
      .select();

    if (error) {
      console.error("Insert error:", error);
      alert("Insert failed. Check console.");
      return;
    }

    console.log("Insert success:", data);
    alert("Intake submitted successfully.");
  });
</script>

</body>
</html>
